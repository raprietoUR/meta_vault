
  
    

        create or replace transient table edw.gen_phase.relationships_seg
         as
        (

SELECT DISTINCT REL.COD_RELATIONSHIP,SEG.ID_SEGMENT, SEG.COD_DATASET_CHILD COD_RELATIONSHIP_CHILD,SEG.COD_DATASET_NAME COD_RELATIONSHIP_NAME
FROM  edw.gen_phase.datasets_segments  SEG
INNER JOIN  edw.gen_phase.relationships REL
ON  SEG.COD_DATASET =REL.REFERENCE_COD_DATASET
WHERE SEG.ID_TYPE_SEGMENT='LINK'
UNION
--AÃ‘ADIMOS LOS LINKS PRINCIPALES
SELECT DISTINCT REL.COD_RELATIONSHIP,0 ID_SEGMENT, REL.COD_RELATIONSHIP COD_RELATIONSHIP_CHILD,REL.COD_RELATIONSHIP_NAME
FROM  edw.gen_phase.relationships REL 
LEFT JOIN  edw.gen_phase.datasets DS on REL.REFERENCE_COD_DATASET = DS.COD_DATASET
        );
      
  