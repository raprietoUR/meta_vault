{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.14", "generated_at": "2024-06-11T09:57:02.513437Z", "invocation_id": "52d4dda7-fc66-4d00-b674-c71fe3dac089", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2024-06-11T09:57:01.896616Z", "completed_at": "2024-06-11T09:57:01.905594Z"}, {"name": "execute", "started_at": "2024-06-11T09:57:01.906246Z", "completed_at": "2024-06-11T09:57:02.369293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6112120151519775, "adapter_response": {}, "message": "Database Error in model TEM_HUBS (models/TEM_GENERATOR/TEM_HUBS.sql)\n  002022 (42601): SQL compilation error:\n  Missing column specification\n  compiled Code at target/run/meta_vault/models/TEM_GENERATOR/TEM_HUBS.sql", "failures": null, "unique_id": "model.meta_vault.TEM_HUBS", "compiled": true, "compiled_code": "\n\nWITH ORIG_BBDD AS (\n    SELECT DIM.COD_DATASET, CON.COD_PATH_1||'.'||CON.COD_PATH_2||'.' AS BBDD_PATH\n    FROM edw.gen_phase.elements DIM \n        JOIN edw.gen_phase.setconnection_connections SETCON ON DIM.COD_SETCONNECTION = SETCON.COD_SETCONNECTION\n        JOIN edw.gen_phase.connections CON ON SETCON.COD_CONNECTION = CON.COD_CONNECTION\n        JOIN edw.gen_phase.environment_connections ECON ON CON.COD_CONNECTION = ECON.COD_CONNECTION\n        WHERE ECON.COD_ENVIRONMENT = 'PRO'\n)\nSELECT DV_ELEMENT.COD_DATASET,\n    (SELECT 'MD5('||LISTAGG(C2.COD_DATASET_FIELD, ',') WITHIN GROUP (ORDER BY C2.ID_ORDER)||') AS HUB_ID'                                                               \n\t\t\t\tFROM edw.gen_phase.elements C2 \n                WHERE DV_ELEMENT.COD_DATASET= C2.COD_DATASET \n                    AND C2.COD_TYPE = 'PK'\n                ) LIST_TARGET_PK,\n    (SELECT LISTAGG(C2.COD_COLUMN_NAME_TARGET, ',') WITHIN GROUP (ORDER BY C2.ID_ORDER)                                                               \n\t\t\t\tFROM edw.gen_phase.elements C2 \n                WHERE DV_ELEMENT.COD_DATASET= C2.COD_DATASET \n                    AND C2.COD_TYPE = 'BK'\n                ) LIST_AKA,\n    (SELECT LISTAGG( '''' || C2.COD_DATASET_FIELD||''' : ' ||  C2.COD_COLUMN_NAME_TARGET , ',') WITHIN GROUP (ORDER BY ID_ORDER)                                                                     \n\t\t\t\tFROM edw.gen_phase.elements C2 WHERE DV_ELEMENT.COD_DATASET= C2.COD_DATASET\n                AND C2.COD_TYPE='PK'\n                ) LIST_TARGET_ID,\n    (SELECT LISTAGG(C2.COD_DATASET_FIELD ||' AS ' ||C2.COD_COLUMN_NAME_TARGET, ',') WITHIN GROUP (ORDER BY C2.ID_ORDER)                          \n\t\t\tFROM edw.gen_phase.elements C2 WHERE DV_ELEMENT.COD_DATASET= C2.COD_DATASET                                                                                                                                                                            \n\t\t\tAND C2.COD_TYPE LIKE '%BK%') LIST_TARGET_BK,\n    'SELECT HUB_ID AS '||DV_ELEMENT.COD_DATASET_NAME||', '||LIST_AKA\n        ||' FROM (SELECT '||LIST_TARGET_PK||', '||LIST_TARGET_BK||' FROM '||ODB.BBDD_PATH||DV_ELEMENT.COD_DATASET_ORIGIN||')'\n    --'CREATE TABLE '||COD_TYPE_DATASET||'_'||COD_DATASET_NAME||' AS ('||query||')' \nFROM edw.gen_phase.elements DV_ELEMENT \n    JOIN ORIG_BBDD ODB ON DV_ELEMENT.COD_DATASET = ODB.COD_DATASET\nWHERE COD_TYPE_DATASET = 'HUB'", "relation_name": "edw.gen_phase.hubs_templates"}], "elapsed_time": 2.1474878787994385, "args": {"populate_cache": true, "invocation_command": "dbt ", "log_level": "info", "enable_legacy_logger": false, "quiet": false, "favor_state": false, "partial_parse": true, "use_colors_file": true, "select": ["TEM_HUBS"], "partial_parse_file_diff": true, "exclude": [], "log_level_file": "debug", "cache_selected_only": false, "strict_mode": false, "write_json": true, "printer_width": 80, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "send_anonymous_usage_stats": true, "log_format": "default", "indirect_selection": "eager", "introspect": true, "which": "run", "defer": false, "log_path": "/Users/raulprieto/Documents/TFG/meta_vault/DBT/projects/meta_vault/logs", "profiles_dir": "/Users/raulprieto/.dbt", "macro_debugging": false, "project_dir": "/Users/raulprieto/Documents/TFG/meta_vault/DBT/projects/meta_vault", "static_parser": true, "vars": {}, "print": true, "log_format_file": "debug", "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": false, "use_colors": true, "log_file_max_bytes": 10485760}}