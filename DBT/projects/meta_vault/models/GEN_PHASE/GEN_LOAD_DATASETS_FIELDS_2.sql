{{ config(
    schema='gen_phase',
    alias='datasets_fields_2',
    materialized='incremental'
) }}

{# SELECT DISTINCT COD_RELATIONSHIP COD_DATASET ,
    CAST(ID_ORDER AS VARCHAR(2)) ID_ORDER,
    DS_FIELDS.REFERENCE_COD_NAME COD_DATASET_FIELD,
    DS_FIELDS.COD_TYPE_RELATIONSHIP COD_TYPE,
    DS_FIELDS.TARGET_FINAL_COD_NAME COD_COLUMN_NAME_TARGET,
    DS_FIELDS.TARGET_FINAL_COD_NAME COD_COLUMN_NAME_TARGET_FLEX_GROUP,
    DS_FIELDS.TARGET_FINAL_COD_NAME COD_BUSINESS_DEFINITION,
    '0' SW_TRACK_DIFF, --PK y FK a 0 
    DS_FIELDS.SW_ACTIVE_VALUE_DEFAULT,
    DS_FIELDS.COLUMN_VALUE_DEFAULT_FX,  
     0 SW_VIRTUAL_FIELD_VALUE,  
    DS_FIELDS.DT_START, DS_FIELDS.DT_END,
    DS_FIELDS.DESC_BUSINESS_DEFINITION
    , DS_FIELDS.SW_CLUSTERIZABLE
FROM  {{ ref('GEN_LOAD_RELATIONSHIPS_FINAL') }} DS_FIELDS
WHERE DS_FIELDS.COD_TYPE_RELATIONSHIP LIKE 'FK%' AND DS_FIELDS.ID_SEGMENT >0 #}